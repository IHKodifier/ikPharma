# ============================================================================
# CUSTOMERS & RELATIONSHIPS
# ============================================================================

"""
Customer entity with tiered pricing.
"""
type Customer @table {
  id: UUID! @default(expr: "uuidV4()")
  business: Business!
  businessId: UUID!

  # Personal Information
  firstName: String! @col(dataType: "varchar(100)")
  lastName: String! @col(dataType: "varchar(100)")
  email: String @col(dataType: "varchar(255)")
  phone: String @col(dataType: "varchar(20)")
  dateOfBirth: Date

  # Address
  address: Address

  # Tier & Pricing
  tier: CustomerTier! @col(dataType: "customer_tier")

  # Insurance
  insuranceProvider: String @col(dataType: "varchar(255)")
  insuranceId: String @col(dataType: "varchar(100)")
  insuranceGroup: String @col(dataType: "varchar(100)")

  # Medical Information
  allergies: [String!] @col(dataType: "jsonb")
  medicalConditions: [String!] @col(dataType: "jsonb")

  # Preferences
  preferredPaymentMethod: PaymentMethod @col(dataType: "payment_method")
  marketingOptIn: Boolean! @default(value: false)

  # Loyalty
  loyaltyPoints: Int! @default(value: 0)
  totalSpent: Float! @default(value: 0)

  # Status
  isActive: Boolean! @default(value: true)

  # Audit
  createdAt: Date! @default(expr: "request.time")
  updatedAt: Date! @default(expr: "request.time")
  createdBy: User!
  createdById: String!
}



